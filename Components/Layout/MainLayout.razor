@inherits LayoutComponentBase
@using Microsoft.Extensions.Localization
@using SAT242516005.Localization
@inject IStringLocalizer<AppResource> L
@inject IJSRuntime JS

<div class="page">
    <div class="sidebar">
        <NavMenu />
    </div>

    <main>
        <div class="top-row px-4 d-flex justify-content-end align-items-center">
            <div class="language-selector me-3">
                @* Onclick içinde doğrudan JS kodunu tetikliyoruz *@
                <button type="button" class="btn btn-link p-0 me-2 border-0"
                        @onclick='() => SetCultureViaJS("tr-TR")'>
                    <img src="https://flagcdn.com/w40/tr.png" width="25" style="border:1px solid #ddd; border-radius:3px; cursor:pointer;" />
                </button>
                <button type="button" class="btn btn-link p-0 border-0"
                        @onclick='() => SetCultureViaJS("en-US")'>
                    <img src="https://flagcdn.com/w40/gb.png" width="25" style="border:1px solid #ddd; border-radius:3px; cursor:pointer;" />
                </button>
            </div>
            <a href="https://www.instagram.com/orcunguless/" target="_blank">@L["Hakkinda"]</a>
        </div>

        <article class="content px-4">
            @Body
        </article>
    </main>
</div>

@code {
    private async Task SetCultureViaJS(string culture)
    {
        // lang.js dosyasına ihtiyaç duymadan, doğrudan tarayıcı komutu gönderiyoruz
        var jsCode = $@"
            document.cookie = '.AspNetCore.Culture=c={culture}|uic={culture};path=/;Max-Age=31536000;SameSite=Lax';
            window.location.reload();
        ";

        try
        {
            await JS.InvokeVoidAsync("eval", jsCode);
        }
        catch (Exception ex)
        {
            Console.WriteLine("Hata: " + ex.Message);
        }
    }
}